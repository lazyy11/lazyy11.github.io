<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>IO管理 | Lazy's Blog</title><meta name="author" content="Lazy,lazy11@foxmail.com"><meta name="copyright" content="Lazy"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="操作系统：输入&#x2F;输出（I&#x2F;O）管理 一、I&#x2F;O管理基础   1. I&#x2F;O设备  定义：可将数据输入计算机或接收计算机输出数据的外部设备，是操作系统设备管理的核心对象，因类型繁多需多维度分类管理。 核心分类：  按信息交换单位：  块设备：以数据块为单位交换信息（如磁盘、磁带）；特性——传输速率高、可寻址（随机读写任意块）。 字符设备：以字符为单位交换信息（如键盘、打印机）；特性——传输速率低、不可">
<meta property="og:type" content="article">
<meta property="og:title" content="IO管理">
<meta property="og:url" content="https://lazy11.top/2025/09/19/%E8%80%83%E7%A0%94/408/OS/IO%E7%AE%A1%E7%90%86/index.html">
<meta property="og:site_name" content="Lazy&#39;s Blog">
<meta property="og:description" content="操作系统：输入&#x2F;输出（I&#x2F;O）管理 一、I&#x2F;O管理基础   1. I&#x2F;O设备  定义：可将数据输入计算机或接收计算机输出数据的外部设备，是操作系统设备管理的核心对象，因类型繁多需多维度分类管理。 核心分类：  按信息交换单位：  块设备：以数据块为单位交换信息（如磁盘、磁带）；特性——传输速率高、可寻址（随机读写任意块）。 字符设备：以字符为单位交换信息（如键盘、打印机）；特性——传输速率低、不可">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://lazy11.top/img/lazy-icon.png">
<meta property="article:published_time" content="2025-09-19T13:32:32.000Z">
<meta property="article:modified_time" content="2025-09-19T13:50:54.180Z">
<meta property="article:author" content="Lazy">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://lazy11.top/img/lazy-icon.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://lazy11.top/2025/09/19/%E8%80%83%E7%A0%94/408/OS/IO%E7%AE%A1%E7%90%86/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.json","preload":true,"top_n_per_article":2,"unescape":false,"languages":{"hits_empty":"No results found for: ${query}","hits_stats":"${hits} articles found"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'IO管理',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  isShuoshuo: false
}</script><link rel="stylesheet" href="/css/font.css"><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src= "/img/lazy-icon.png" data-lazy-src="/img/lazy-icon.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">44</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">42</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">22</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Timeline</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/artitalk/"><i class="fa-fw fas fa-comments"></i><span> Daily Musings</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Links</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background: linear-gradient(45deg, #002FA7, #00B4FF);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src= "/img/lazy-icon.png" data-lazy-src="/img/index.png" alt="Logo"></a><a class="nav-page-title" href="/"><span class="site-name">IO管理</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Timeline</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/artitalk/"><i class="fa-fw fas fa-comments"></i><span> Daily Musings</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Links</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">IO管理</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-09-19T13:32:32.000Z" title="Created 2025-09-19 21:32:32">2025-09-19</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-09-19T13:50:54.180Z" title="Updated 2025-09-19 21:50:54">2025-09-19</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span class="waline-pageview-count" data-path="/2025/09/19/%E8%80%83%E7%A0%94/408/OS/IO%E7%AE%A1%E7%90%86/"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1>操作系统：输入/输出（I/O）管理</h1>
<h3 id="一、I-O管理基础"><strong>一、I/O管理基础</strong></h3>
<ul>
<li>
<p><strong>1. I/O设备</strong></p>
<ul>
<li><strong>定义</strong>：可将数据输入计算机或接收计算机输出数据的外部设备，是操作系统设备管理的核心对象，因类型繁多需多维度分类管理。</li>
<li><strong>核心分类</strong>：
<ul>
<li>按信息交换单位：
<ul>
<li>块设备：以数据块为单位交换信息（如磁盘、磁带）；特性——传输速率高、可寻址（随机读写任意块）。</li>
<li>字符设备：以字符为单位交换信息（如键盘、打印机）；特性——传输速率低、不可寻址，常用中断I/O方式。</li>
</ul>
</li>
<li>按传输速率：
<ul>
<li>低速设备：每秒几字节至数百字节（如键盘、鼠标）。</li>
<li>中速设备：每秒数千字节至数万字节（如激光打印机）。</li>
<li>高速设备：每秒数百千字节至千兆字节（如磁盘、光盘）。</li>
</ul>
</li>
<li>按使用特性：
<ul>
<li>人机交互设备：用户与计算机交互（如键盘、显示器、打印机）。</li>
<li>存储设备：存储信息（如磁盘、磁带、光盘）。</li>
<li>网络通信设备：计算机间通信（如网卡、调制解调器）。</li>
</ul>
</li>
<li>按共享属性：
<ul>
<li>独占设备：同一时刻仅一个进程占用（如打印机）；常按独占管理（与速度无必然关系），分配后独占至释放。</li>
<li>共享设备：同一时间段允许多进程分时访问（如磁盘）；通过分时共享提升利用率。</li>
<li>虚拟设备：通过SPOOLing技术将独占设备改造为共享设备（如虚拟打印机）；一个物理设备映射为多个逻辑设备。</li>
</ul>
</li>
</ul>
</li>
<li><strong>I/O接口（设备控制器）</strong>：
<ul>
<li><strong>定义</strong>：CPU与设备间的“桥梁”，接收CPU命令并控制设备工作，解放CPU的设备控制事务。</li>
<li><strong>结构/组成</strong>：
<ul>
<li>设备控制器与CPU的接口：含数据线（传数据/控制/状态信息）、地址线（传I/O端口寄存器编号）、控制线（传读写控制信号）。</li>
<li>设备控制器与设备的接口：一个控制器可连1个或多个设备，每个接口传数据、控制、状态信号。</li>
<li>I/O逻辑：译码CPU的I/O命令，控制所选设备；CPU启动设备时，通过地址线传地址，I/O逻辑译码后控制设备。</li>
</ul>
</li>
<li><strong>核心功能</strong>：接收和识别命令（如磁盘的读/写/查找命令）；数据交换（CPU-控制器、控制器-设备）；标识和报告设备状态；地址识别；数据缓冲；差错控制。</li>
</ul>
</li>
<li><strong>I/O端口</strong>：
<ul>
<li><strong>定义</strong>：设备控制器中可被CPU直接访问的寄存器，是CPU与设备通信的关键节点。</li>
<li><strong>核心类型</strong>：
<ul>
<li>数据寄存器：缓存设备输入数据或CPU输出数据。</li>
<li>状态寄存器：保存设备执行结果/状态信息，供CPU读取。</li>
<li>控制寄存器：CPU写入以启动命令或更改设备模式。</li>
</ul>
</li>
<li><strong>编址方式</strong>：
<ul>
<li>独立编址：
<ul>
<li>定义：为端口分配独立I/O端口号，地址空间与主存独立（可重叠），需专用I/O指令访问。</li>
<li>优点：端口数少，译码简单、寻址快；专用指令使程序清晰。</li>
<li>缺点：I/O指令少，程序灵活性差；CPU需两组独立读写控制信号，控制复杂。</li>
</ul>
</li>
<li>统一编址（内存映射I/O）：
<ul>
<li>定义：主存地址空间分出部分给端口，与主存同一地址空间，用访存指令访问。</li>
<li>优点：无需专用I/O指令，访问灵活；端口编址空间大；保护机制可通过虚拟存储实现。</li>
<li>缺点：端口地址占用主存空间；全地址线译码，电路复杂、寻址慢。</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>2. I/O控制方式</strong></p>
<ul>
<li><strong>核心目标</strong>：减少CPU对I/O控制的干预，解放CPU以执行更多运算任务，随技术发展逐步降低CPU干预程度。</li>
<li><strong>分类与细节</strong>：
<ul>
<li><strong>程序直接控制方式（轮询方式）</strong>：
<ul>
<li>定义：CPU通过轮询（循环测试设备状态）控制I/O，发出I/O指令后持续检测设备，直至数据就绪。</li>
<li>工作流程：
<ol>
<li>CPU向设备控制器发I/O指令（如读1字节）。</li>
<li>CPU循环测试设备状态寄存器（轮询）。</li>
<li>设备就绪后，CPU从数据寄存器取数据存入内存。</li>
</ol>
</li>
<li>优点：实现简单、无需硬件支持。</li>
<li>缺点：CPU利用率极低（大部分时间等待）；CPU与I/O设备串行工作。</li>
</ul>
</li>
<li><strong>中断驱动方式</strong>：
<ul>
<li>定义：允许I/O设备主动发中断请求，CPU发I/O指令后可执行其他任务，设备就绪后中断CPU处理。</li>
<li>工作流程（双视角）：
<ul>
<li>设备控制器视角：接收读命令→读数据至数据寄存器→发中断信号→等待CPU取数据→传数据至CPU。</li>
<li>CPU视角：进程发读命令→进程阻塞→CPU执行其他程序→检测到中断→保存当前上下文→执行中断处理程序（取数据存内存）→唤醒进程→恢复上下文。</li>
</ul>
</li>
<li>优点：CPU与设备并行工作，CPU利用率显著提升。</li>
</ul>
</li>
<li>缺点：若无DMA协作，数据路径经CPU寄存器且单位较细；配合DMA可显著降低CPU搬运开销。</li>
<li><strong>DMA方式（直接存储器存取）</strong>：
<ul>
<li>定义：在I/O设备与内存间开辟直接数据通路，以块为单位传输数据，CPU仅在传输开始和结束时干预。</li>
<li><strong>结构/组成（DMA控制器）</strong>：
<ul>
<li>命令/状态寄存器（CR）：暂存CPU的I/O命令或设备状态。</li>
<li>内存地址寄存器（MAR）：输入时存内存目标起始地址，输出时存内存源地址。</li>
<li>数据寄存器（DR）：暂存设备与内存间传输的数据。</li>
<li>数据计数器（DC）：存本次传输的字节数。</li>
</ul>
</li>
<li>工作流程：
<ol>
<li>CPU接收DMA请求→设置MAR和DC初值→启动DMA控制器→继续其他任务。</li>
<li>DMA控制器直接与内存交互，以突发方式传输数据（经总线仲裁，无需CPU参与数据路径）。</li>
<li>传输结束后，DMA控制器发中断信号→CPU处理中断。</li>
</ol>
</li>
<li>优点：以“块”为单位传输，CPU干预频率低；数据不经过CPU寄存器，并行性更高。</li>
</ul>
</li>
<li><strong>通道控制方式</strong>：
<ul>
<li>定义：通过特殊处理机（通道）执行通道指令，CPU仅需发I/O指令指明通道程序位置，通道完成I/O后发中断。</li>
<li>核心特点：
<ul>
<li>与一般处理机区别：通道指令类型单一，无独立内存，共享主机内存。</li>
</ul>
</li>
</ul>
</li>
<li>与DMA区别：通道具通道指令与通道程序，可自主编排复杂I/O流程并多路管理设备；DMA多提供固定搬运原语（尽管可具多通道/多队列）。
<ul>
<li>优点：实现CPU、通道、I/O设备三者并行，资源利用率最高。</li>
<li>缺点：硬件成本高，需专用通道硬件。</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>3. I/O软件层次结构</strong></p>
<ul>
<li><strong>定义</strong>：为实现I/O软件的清晰结构、可移植性和适应性，采用分层设计，每层利用下层服务并向上层提供服务，屏蔽实现细节。</li>
<li><strong>四层结构与功能</strong>：
<ul>
<li><strong>用户层软件</strong>：
<ul>
<li>定义：与用户交互的接口层，含I/O相关库函数（如C语言的<code>scanf</code>/<code>printf</code>）。</li>
<li>核心功能：产生I/O请求；格式化I/O数据（如二进制转ASCII）；实现SPOOLing用户端逻辑；通过系统调用获取OS服务。</li>
</ul>
</li>
<li><strong>设备独立性软件（设备无关软件）</strong>：
<ul>
<li>定义：位于驱动程序之上，实现设备无关性（应用程序不依赖具体物理设备）。</li>
<li>核心概念：引入逻辑设备名（应用程序使用）和物理设备名（系统实际执行时使用），通过映射实现设备无关。</li>
<li>核心功能：
<ul>
<li>公有操作：设备分配与回收；逻辑设备名→物理设备名映射；设备保护（禁止用户直接访问）；缓冲管理；差错控制；屏蔽设备信息交换单位差异。</li>
<li>统一接口：向用户层提供统一I/O接口（如<code>read</code>/<code>write</code>命令），无关设备类型。</li>
</ul>
</li>
<li>优点：增加设备分配灵活性；实现I/O重定向（更换设备无需修改应用程序）。</li>
</ul>
</li>
<li><strong>设备驱动程序</strong>：
<ul>
<li>定义：与硬件直接相关的通信程序，每类设备对应一个驱动程序，是I/O进程与设备控制器的桥梁。</li>
<li>核心功能：
<ul>
<li>接收上层抽象I/O请求（如<code>read</code>），转换为设备具体命令（如磁盘的磁道/扇区定位）。</li>
<li>检查I/O请求合法性，获取设备状态，设置设备工作方式。</li>
<li>启动I/O设备（设备空闲则启动，忙则挂起进程至设备队列）。</li>
<li>响应设备控制器中断，调用对应中断处理程序。</li>
</ul>
</li>
<li>特点：硬件相关性强；与I/O控制方式（中断/DMA）紧密相关；部分固化在ROM中；支持多进程并发调用。</li>
</ul>
</li>
<li><strong>中断处理程序</strong>：
<ul>
<li>定义：I/O操作完成后，设备控制器发中断，CPU响应后执行的处理程序，位于OS底层。</li>
<li>核心任务：进程上下文切换；测试中断信号源；读取设备状态；修改进程状态（如唤醒阻塞进程）。</li>
<li>特点：与硬件紧密相关，需尽量屏蔽用户访问；仅底层涉及硬件特性。</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>4. 应用程序I/O接口</strong></p>
<ul>
<li><strong>定义</strong>：I/O系统与高层（用户程序/文件系统）的交互接口，按设备类型分类，支持不同I/O模式。</li>
<li><strong>接口分类</strong>：
<ul>
<li><strong>字符设备接口</strong>：
<ul>
<li>定义：面向字符设备（如键盘、打印机）的接口，数据以字符为单位传输，不可寻址，常用中断驱动。</li>
<li>核心操作：
<ul>
<li><code>get</code>/<code>put</code>操作：通过字符缓冲区顺序存取（不可寻址），<code>get</code>从缓冲区取字符，<code>put</code>向缓冲区存字符。</li>
<li><code>in-control</code>指令：处理设备特定功能（含多个设备相关参数）。</li>
<li>打开/关闭操作：实现独占设备的互斥共享。</li>
</ul>
</li>
</ul>
</li>
<li><strong>块设备接口</strong>：
<ul>
<li>定义：面向块设备（如磁盘）的接口，数据以块为单位传输，可寻址，常用DMA方式。</li>
<li>核心功能：
<ul>
<li>命令映射：将上层打开/读/写/关闭命令，转换为设备具体操作（如磁盘的扇区访问）。</li>
<li>地址转换：屏蔽磁盘二维结构（磁道号+扇区号），将扇区线性编号（0~n-1）。</li>
<li>内存映射接口：将磁盘文件映射为虚拟内存地址，访问内存即访问磁盘（无需显式读/写命令）。</li>
</ul>
</li>
</ul>
</li>
<li><strong>网络设备接口</strong>：
<ul>
<li>定义：支持计算机间网络通信的接口，实现数据的网络传输。</li>
<li>核心实现：常用网络套接字（Socket）接口，通过系统调用创建本地套接字并连接远程套接字，实现数据收发（如TCP/UDP通信）。</li>
</ul>
</li>
</ul>
</li>
<li><strong>I/O模式（阻塞/非阻塞）</strong>：
<ul>
<li><strong>阻塞I/O</strong>：
<ul>
<li>定义：进程调用I/O操作后立即阻塞（移至阻塞队列），I/O完成后唤醒（移至就绪队列），恢复执行后接收返回值。</li>
<li>示例：咖啡店点单后等待取餐，无法做其他事。</li>
<li>优点：实现简单，适合并发量小的场景。</li>
<li>缺点：I/O执行阶段进程持续阻塞，CPU资源可能闲置。</li>
</ul>
</li>
<li><strong>非阻塞I/O</strong>：
<ul>
<li>定义：调用立即返回，进程可继续执行；可通过轮询或事件通知查询完成。是否由内核在完成时复制数据属于同步/异步语义，非阻塞本身不等于异步。</li>
<li>示例：咖啡店点单后逛商场，定期返回询问取餐状态。</li>
<li>优点：进程等待I/O时可处理其他任务，适合并发量大的场景。</li>
<li>缺点：轮询占用CPU时间，增加系统开销。</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="二、设备独立软件"><strong>二、设备独立软件</strong></h3>
<ul>
<li>
<p><strong>1. 缓冲区管理</strong></p>
<ul>
<li>
<p><strong>定义</strong>：通过在内存中设置缓冲区，缓和CPU与I/O设备速度不匹配矛盾，提升I/O效率的管理机制。</p>
</li>
<li>
<p><strong>核心目的</strong>：</p>
<ul>
<li>缓和CPU与I/O设备速度差异；减少CPU中断频率；解决数据单元大小不匹配问题；提高CPU与I/O并行性。</li>
</ul>
</li>
<li>
<p><strong>缓冲区类型与细节</strong>：</p>
<ul>
<li><strong>单缓冲</strong>：
<ul>
<li>定义：为每个I/O请求分配1个缓冲区（大小为1块），设备与CPU对缓冲区操作串行。</li>
<li>时间计算：设设备输入1块数据时间为<code>T</code>，数据传至用户工作区时间为<code>M</code>，CPU处理时间为<code>C</code>，则平均处理时间为 <code>Max(C, T) + M</code>。</li>
<li>特点：<code>T</code>与<code>C</code>可并行；缓冲区为临界资源，需互斥访问（设备未取走数据则需等待）。</li>
</ul>
</li>
<li><strong>双缓冲（缓冲对换）</strong>：
<ul>
<li>定义：设置2个缓冲区，设备交替向两缓冲区输入，CPU交替从两缓冲区取数据处理，提升并行度。</li>
<li>时间计算：平均处理时间为 <code>Max(C + M, T)</code>。</li>
<li>特点：<code>C</code>与<code>M</code>可与<code>T</code>并行；适合设备与CPU速度差异较大场景；支持双机双向数据传输（需双方各设双缓冲）。</li>
</ul>
</li>
<li><strong>循环缓冲</strong>：
<ul>
<li>定义：由多个大小相等的缓冲区组成循环队列，设<code>in</code>（指向空缓冲区）、<code>out</code>（指向满缓冲区）指针，按循环方式存取数据。</li>
<li>适用场景：设备与CPU速度差异极大，双缓冲效果不佳时（如高速磁盘与CPU交互）。</li>
</ul>
</li>
<li><strong>缓冲池</strong>：
<ul>
<li>定义：含多个公用缓冲区的管理机制，供多进程共享，通过队列和工作缓冲区实现高效管理。</li>
<li><strong>结构/组成</strong>：
<ul>
<li>队列：空缓冲队列（空缓冲区链接）、输入队列（装满输入数据的缓冲区链接）、输出队列（装满输出数据的缓冲区链接）。</li>
<li>工作缓冲区：收容输入（<code>hin</code>）、提取输入（<code>sin</code>）、收容输出（<code>hout</code>）、提取输出（<code>sout</code>）。</li>
</ul>
</li>
<li>核心工作方式：
<ul>
<li>收容输入：从空队列取缓冲区→存输入数据→挂至输入队列。</li>
<li>提取输入：从输入队列取缓冲区→提取数据→挂至空队列。</li>
<li>收容输出：从空队列取缓冲区→存输出数据→挂至输出队列。</li>
<li>提取输出：从输出队列取缓冲区→提取数据→挂至空队列。</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>高速缓存与缓冲区对比</strong>：</p>
<ul>
<li>高速缓存：存放高速设备（如CPU）经常访问的数据，若数据未命中则访问原始数据；目的是提升高速设备访问效率。</li>
<li>缓冲区：存放低速设备与高速设备间传输的数据（如磁盘→内存）；目的是缓和速度差异，减少中断。</li>
</ul>
</li>
<li>
<p>【408易考】缓存与写策略（与外存I/O优化相关）：</p>
<ul>
<li>读预取（提前读）：基于顺序访问预测预读相邻块，降低平均访问延迟。</li>
<li>写回（延迟写）：先写缓存，后台批量回写磁盘；崩溃可能丢数据，需要适时flush/fsync以保证关键数据持久。</li>
<li>直写/直达（write-through/direct I/O）：跳过页缓存或同时写入外存，延迟低但吞吐较差，适合数据库日志等场景。</li>
<li>命中/替换：结合LRU/LFU/Clock等策略（考纲基础识别即可）。</li>
<li>【考纲外】写屏障/顺序保证：barrier、FUA、cache flush 指令配合日志/校验以保证崩溃一致性。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>2. 设备分配与回收</strong></p>
<ul>
<li>
<p><strong>定义</strong>：根据用户I/O请求，按“充分利用设备效率、避免死锁”原则，分配/回收设备、控制器、通道的过程。</p>
</li>
<li>
<p><strong>核心数据结构</strong>：</p>
<ul>
<li><strong>设备控制表（DCT）</strong>：
<ul>
<li>定义：系统为每个设备配置的表，记录设备属性。</li>
<li>核心字段：设备类型、设备标识符（物理设备名）、设备状态（忙/闲）、指向控制器表（COCT）的指针、重复执行次数/时间、设备等待队列队首指针。</li>
</ul>
</li>
<li><strong>控制器控制表（COCT）</strong>：
<ul>
<li>定义：每个设备控制器对应一张表，记录控制器属性。</li>
<li>核心字段：控制器标识符、控制器状态（忙/闲）、指向通道表（CHCT）的指针、控制器等待队列队首/队尾指针。</li>
</ul>
</li>
<li><strong>通道控制表（CHCT）</strong>：
<ul>
<li>定义：每个通道对应一张表，记录通道属性。</li>
<li>核心字段：通道标识符、通道状态（忙/闲）、与通道连接的控制器表首址、通道等待队列队首/队尾指针。</li>
</ul>
</li>
<li><strong>系统设备表（SDT）</strong>：
<ul>
<li>定义：整个系统唯一，记录所有物理设备信息。</li>
<li>核心字段：设备标识符、设备类、驱动程序入口、指向对应DCT的指针。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>设备分配考虑因素</strong>：</p>
<ul>
<li><strong>设备固有属性</strong>：
<ul>
<li>独占设备：分配给进程后独占至释放（如打印机），采用独占分配策略。</li>
<li>共享设备：分时分配给多个进程（如磁盘），需调度访问顺序。</li>
<li>虚拟设备：通过SPOOLing改造的共享设备（如虚拟打印机），按共享设备分配。</li>
</ul>
</li>
<li><strong>分配算法</strong>：
<ul>
<li>先来先服务（FCFS）：按请求先后排序，优先分配给队首进程，公平性好。</li>
<li>最高优先级优先：按进程优先级排序，优先级高的请求优先分配，适合实时系统。</li>
</ul>
</li>
<li><strong>分配安全性</strong>：
<ul>
<li>安全分配方式：进程发I/O请求后立即阻塞，直至I/O完成；优点是无死锁风险，缺点是CPU与I/O串行。</li>
<li>不安全分配方式：进程发I/O请求后继续运行，可发多个I/O请求；优点是进程推进快，缺点是可能死锁。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>设备分配步骤（以独占设备为例）</strong>：</p>
<ol>
<li>分配设备：查SDT→找对应DCT→设备闲则分配，忙则挂进程至设备等待队列。</li>
<li>分配控制器：查DCT→找对应COCT→控制器闲则分配，忙则挂进程至控制器等待队列。</li>
<li>分配通道：查COCT→找对应CHCT→通道闲则分配，忙则挂进程至通道等待队列；三者均分配成功则启动设备。</li>
</ol>
</li>
<li>
<p><strong>逻辑设备名→物理设备名映射</strong>：</p>
<ul>
<li>实现工具：逻辑设备表（LUT），记录逻辑设备名、物理设备名、驱动程序入口。</li>
<li>LUT设置方式：
<ul>
<li>系统级LUT：全系统1张，所有进程共享，要求用户逻辑设备名唯一（适合单用户系统）。</li>
<li>用户级LUT：为每个用户设1张，不同用户可使用相同逻辑设备名（适合多用户系统）。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>设备回收</strong>：进程释放设备时，将对应DCT的设备状态设为“闲”，若设备等待队列有进程则唤醒队首进程并分配设备。</p>
</li>
<li>
<p>【408易考】设备独占导致的死锁与规避：</p>
<ul>
<li>死锁必要条件：互斥、占有且等待、不剥夺、循环等待。</li>
<li>案例：进程P1占用打印机请求磁带机，P2占用磁带机请求打印机→循环等待。</li>
<li>规避策略：
<ul>
<li>破坏“占有且等待”：一次性申请所需全部独占设备（代价：资源利用率下降）。</li>
<li>破坏“不可剥夺”：超时或系统支持强制释放回滚（常用于作业/事务层）。</li>
<li>破坏“循环等待”：为设备设全序，按序号递增申请；或采用银行家算法在可安全状态下授予（考纲常识）。</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>3. SPOOLing技术（假脱机技术）</strong></p>
<ul>
<li><strong>定义</strong>：通过软件模拟脱机输入/输出的外围控制机，将独占设备改造为共享设备的技术，核心是“以空间换时间”。</li>
<li><strong>结构/组成</strong>：
<ul>
<li>输入井/输出井：磁盘上开辟的存储区域，输入井收容设备输入数据，输出井收容用户输出数据。</li>
<li>输入缓冲区/输出缓冲区：内存中开辟的缓冲区，暂存设备与输入井/输出井间的数据。</li>
<li>输入进程/输出进程：模拟外围控制机，输入进程将设备数据→输入缓冲区→输入井；输出进程将内存数据→输出井→输出缓冲区→输出设备。</li>
<li>井管理程序：控制作业与磁盘井间的信息交换。</li>
</ul>
</li>
<li><strong>核心工作流程（以打印机为例）</strong>：
<ol>
<li>多进程发打印请求→SPOOLing系统接收请求，不立即分配打印机。</li>
<li>为每个进程在输出井分配空闲盘块→存打印数据；创建用户请求打印表→记录打印要求→挂至打印队列。</li>
<li>打印机空闲时，输出进程从打印队列取任务→将输出井数据→输出缓冲区→打印机。</li>
</ol>
</li>
<li><strong>特点</strong>：
<ul>
<li>提高I/O速度：将低速设备操作转为磁盘缓冲存取，缓和CPU与低速设备速度差异。</li>
<li>改造独占设备：将打印机等独占设备变为共享设备，提升设备利用率。</li>
<li>实现虚拟设备：每个进程认为独占设备（逻辑设备），实际共享物理设备。</li>
</ul>
</li>
<li><strong>核心思想（空间换时间）</strong>：牺牲磁盘空间（输入井/输出井），减少CPU等待低速设备的时间（向磁盘写数据速度远快于向打印机写数据）。</li>
</ul>
</li>
<li>
<p><strong>4. 设备驱动程序接口</strong></p>
<ul>
<li><strong>定义</strong>：设备驱动程序与上层软件（设备独立性软件）的交互接口，规范命令传递和状态反馈，实现“上层接口统一，下层硬件屏蔽”。</li>
<li><strong>核心功能</strong>：
<ul>
<li>命令转换：接收上层抽象I/O请求（如<code>read</code>），转换为设备具体命令（如磁盘的磁道/扇区定位命令）。</li>
<li>参数传递：传递设备操作参数（如数据传输长度、内存地址），设置设备工作模式。</li>
<li>状态反馈：将设备控制器的状态信息（如忙/闲、错误码）反馈给上层软件。</li>
<li>中断协作：与中断处理程序协作，响应设备中断，处理I/O完成或错误事件。</li>
</ul>
</li>
<li><strong>接口设计目标</strong>：
<ul>
<li>统一性：所有设备驱动程序与OS的接口一致，便于添加新驱动。</li>
<li>设备无关性：上层软件通过逻辑设备名访问，驱动程序负责逻辑→物理映射。</li>
<li>安全性：防止无权用户直接访问设备，通过驱动程序实现设备保护。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="三、外存管理"><strong>三、外存管理</strong></h3>
<ul>
<li>
<p><strong>1. 磁盘管理</strong></p>
<ul>
<li><strong>磁盘结构</strong>：
<ul>
<li>物理组成：由盘片、磁头、磁头臂、转轴组成；多个盘片堆叠成磁盘组，每个盘面对应1个磁头，所有磁头“共进退”。</li>
<li>存储单位：
<ul>
<li>磁道：盘面上的同心圆，一个盘面含上千个磁道。</li>
<li>扇区：磁道划分的最小可寻址单位（典型为512B或4KB），相邻扇区间有间隙。</li>
<li>柱面：所有盘片上相对位置相同的磁道组成，是磁盘寻道的基本单位。</li>
</ul>
</li>
<li>磁盘地址：用“柱面号·盘面号·扇区号”表示，唯一标识一个扇区。</li>
<li>容量计算：磁盘容量 = 磁头数（盘面数）× 磁道数/盘面 × 扇区数/磁道 × 扇区大小。</li>
</ul>
</li>
<li><strong>磁盘初始化与分区</strong>：
<ul>
<li><strong>低级格式化（物理格式化）</strong>：
<ul>
<li>定义：磁盘出厂或初始化时，将磁盘划分为扇区，为每个扇区添加头部（扇区号、磁道号）、尾部（CRC校验）的过程。</li>
<li>作用：使磁盘控制器可识别扇区；记录扇区映射（标记坏块）；指定扇区数据区大小（如256B/512B）。</li>
</ul>
</li>
<li><strong>分区</strong>：
<ul>
<li>定义：将磁盘划分为多个独立区域（如C盘、D盘），每个分区含一个或多个柱面，分区信息记录在磁盘主引导记录（MBR）的分区表中。</li>
<li>作用：隔离不同文件系统或操作系统，便于管理。</li>
</ul>
</li>
<li><strong>高级格式化（逻辑格式化）</strong>：
<ul>
<li>定义：对分区创建文件系统的过程，初始化文件系统数据结构。</li>
<li>作用：建立根目录；初始化空闲/已分配空间管理结构（如FAT、inode）；创建引导扇区。</li>
</ul>
</li>
</ul>
</li>
<li><strong>磁盘引导</strong>：
<ul>
<li>引导程序存储：ROM中存小型自举装入程序，磁盘启动块（如MBR）存完整引导程序。</li>
<li>引导流程（以Windows为例）：
<ol>
<li>计算机启动→ROM自举程序运行→读取磁盘MBR（第0扇区）。</li>
<li>MBR含引导代码和分区表→引导代码查分区表→找引导分区。</li>
<li>读取引导分区的引导扇区→执行分区引导程序→加载操作系统内核。</li>
</ol>
</li>
</ul>
</li>
<li><strong>坏块处理</strong>：
<ul>
<li>手动处理：逻辑格式化时扫描坏块，在文件系统（如FAT）中标注，避免使用（适合简单磁盘）。</li>
<li>自动处理：控制器维护坏块列表，用备用块替代坏块（扇区备用），操作系统不可见坏块（适合复杂磁盘）。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>2. 磁盘调度算法</strong></p>
<ul>
<li>
<p><strong>核心目标</strong>：减少磁盘平均寻道时间（寻道时间占磁盘存取时间的比例最大），提升磁盘I/O效率。</p>
</li>
<li>
<p><strong>磁盘存取时间构成</strong>：</p>
<ul>
<li>寻道时间（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">T_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>）：磁头移动到目标磁道的时间，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>s</mi></msub><mo>=</mo><mi>m</mi><mo>×</mo><mi>n</mi><mo>+</mo><mi>s</mi></mrow><annotation encoding="application/x-tex">T_s = m \times n + s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span>（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>为跨磁道时间，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>为跨磁道数，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span>为磁头启动时间）。</li>
<li>旋转延迟时间（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">T_r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>）：磁头定位到目标扇区的时间，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>r</mi></msub><mo>=</mo><mfrac><mn>1</mn><mrow><mn>2</mn><mi>r</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">T_r = \frac{1}{2r}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span>为磁盘旋转速度，单位：转/秒）。</li>
<li>传输时间（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">T_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>）：读写数据的时间，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>t</mi></msub><mo>=</mo><mfrac><mi>b</mi><mrow><mi>r</mi><mo>×</mo><mi>N</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">T_t = \frac{b}{r \times N}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2834em;vertical-align:-0.4033em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4033em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span>为数据字节数，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>为一个磁道的字节数）。</li>
<li>总存取时间：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>a</mi></msub><mo>=</mo><msub><mi>T</mi><mi>s</mi></msub><mo>+</mo><msub><mi>T</mi><mi>r</mi></msub><mo>+</mo><msub><mi>T</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">T_a = T_s + T_r + T_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>。</li>
</ul>
</li>
<li>
<p>说明（统一示例假设）：以下各算法示例假定磁道范围为[0, 200]，磁头初始在100，初始方向为“向增大”；C-SCAN返回段计入总移动。</p>
</li>
<li>
<p><strong>调度算法分类与细节</strong>：</p>
<ul>
<li><strong>先来先服务（FCFS）</strong>：
<ul>
<li>定义：按进程请求访问磁盘的先后顺序调度。</li>
<li>优点：公平性好，实现简单。</li>
<li>缺点：平均寻道时间大，请求密集时性能接近随机调度。</li>
<li>示例：请求序列55,58,39,18,90,160,150,38,184，磁头初始位100→总移动磁道数498，平均寻道长度55.3。</li>
<li>【408要点】是否饥饿：否；响应时间均匀性：差；适用：轻载/教学。</li>
</ul>
</li>
<li><strong>最短寻道时间优先（SSTF）</strong>：
<ul>
<li>定义：每次选择离当前磁头最近的磁道调度。</li>
<li>优点：平均寻道时间比FCFS小，性能更优。</li>
<li>缺点：可能产生“饥饿”（近磁道请求频繁，远磁道请求长期等待）。</li>
<li>示例：同上述请求序列→调度顺序100→90→58→55→39→38→18→150→160→184→总移动248，平均27.5。</li>
<li>【408要点】是否饥饿：可能；响应时间均匀性：一般；适用：追求吞吐的普通负载。</li>
</ul>
</li>
<li><strong>扫描（SCAN）算法（电梯调度）</strong>：
<ul>
<li>定义：磁头沿固定方向移动（如磁道号增大），服务沿途请求，到达端点后反向移动并服务请求。</li>
<li>优点：消除“饥饿”，对两端磁道请求公平。</li>
<li>缺点：对最近扫描过的区域请求不公平。</li>
<li>示例：同上述请求序列，磁头向增大方向移动→调度顺序100→150→160→184→200（端点）→90→58→55→39→38→18→总移动282，平均31.33。</li>
<li>【408要点】是否饥饿：基本无；响应时间均匀性：中；适用：机械盘典型场景。</li>
</ul>
</li>
<li><strong>循环扫描（C-SCAN）算法</strong>：
<ul>
<li>定义：磁头单向移动，服务沿途请求，到达端点后直接快速返回起始端（不服务请求），再单向服务。</li>
<li>优点：避免SCAN对两端磁道的偏向，请求响应时间更均匀。</li>
<li>缺点：返回时无服务，增加部分寻道时间。</li>
<li>示例：同上述请求序列，磁头向增大方向移动→调度顺序100→150→160→184→200→0→18→38→39→55→58→90→总移动390，平均43.33。</li>
<li>【408要点】是否饥饿：基本无；响应时间均匀性：优；适用：响应时间均匀性要求更高。</li>
</ul>
</li>
<li><strong>LOOK/C-LOOK算法（改进版）</strong>：
<ul>
<li>定义：SCAN/C-SCAN的改进，磁头仅移动到最远端的请求磁道（无需到端点），减少无效寻道。</li>
<li>【408要点】是否饥饿：基本无；响应时间均匀性：对应算法略优；适用：减少无效移动。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>减少延迟时间的方法</strong>：</p>
<ul>
<li>扇区交替编号：逻辑相邻扇区物理上间隔排列（如8扇区编号0,3,6,1,4,7,2,5），减少连续读时的旋转延迟。</li>
<li>盘面错位命名：不同盘面的扇区编号错位（如0号盘面扇区0对应1号盘面扇区4），减少跨盘面读时的延迟。</li>
</ul>
</li>
<li>
<p>小结（【408易考】调度算法对比）：</p>
<ul>
<li>FCFS：公平，简单；平均寻道时间大，无饥饿；适合轻载/教学示例。</li>
<li>SSTF：平均寻道短；可能饥饿；适合负载集中但需注意公平性。</li>
<li>SCAN：电梯式，往返服务；较均衡，端点等待不至长期饥饿；响应时间对中部更友好。</li>
<li>C-SCAN：单向服务+回卷；响应时间更均匀；回卷段无服务带来额外移动。</li>
<li>LOOK/C-LOOK：只到最远请求，减少无效寻道；其他性质类似对应算法。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>3. 固态硬盘（SSD）管理</strong></p>
<ul>
<li><strong>结构与特性</strong>：
<ul>
<li>物理组成：由闪存芯片和闪存翻译层组成，闪存芯片替代机械磁盘，闪存翻译层实现逻辑块→物理块的映射（类似磁盘控制器）。</li>
<li>存储单位：
<ul>
<li>页（Page）：最小编程/读单位（常见4KB~16KB）。</li>
<li>块（Block）：最小擦除单位（由若干页组成，常见数十到数百页）；仅块擦除后才能改写页数据。</li>
</ul>
</li>
<li>核心特性：
<ul>
<li>优点：无机械部件，随机访问速度快（无寻道/旋转延迟），低功耗、抗震、无噪声。</li>
<li>缺点：随机写速度慢（需先擦除块）；闪存擦写寿命有限（约10^2—10^5次，视SLC/MLC/TLC/QLC而定）。</li>
</ul>
</li>
</ul>
</li>
<li><strong>磨损均衡技术</strong>：
<ul>
<li><strong>定义</strong>：通过算法使闪存各块擦写次数均匀，延长SSD寿命的技术。</li>
<li><strong>分类</strong>：
<ul>
<li>动态磨损均衡：写入数据时优先选择擦除次数少的块，避免某块过度磨损。</li>
<li>静态磨损均衡：无数据写入时，自动迁移长期存放数据的块（读多写少），让擦除次数少的块承担写任务，均衡各块磨损。</li>
</ul>
</li>
</ul>
</li>
<li><strong>与机械磁盘的差异</strong>：
<ul>
<li>无需磁盘调度算法（无寻道/旋转延迟）。</li>
<li>需磨损均衡管理，机械磁盘无需。</li>
<li>随机读写性能远超机械磁盘，连续读写性能接近或略优。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>4. 提高磁盘I/O速度的方法</strong></p>
<ul>
<li>采用磁盘高速缓存：用内存暂存磁盘数据，减少磁盘访问次数。</li>
<li>调整I/O请求次序：使用SCAN、SSTF等调度算法，减少寻道时间。</li>
<li>提前读：读当前块时，预读下一块至缓冲区，应对顺序访问。</li>
<li>延迟写：数据先写入缓冲区，缓冲区需重用时再写磁盘，减少磁盘写次数；注意崩溃后一致性风险，可结合flush/fsync或日志策略保障。</li>
<li>优化物理块分布：同一文件的块尽量安排在同一柱面或相邻磁道，减少寻道；按簇分配文件（多个扇区组成一簇），减少磁头移动。</li>
<li>虚拟盘（RAM盘）：用内存模拟磁盘，存放临时文件，访问速度极快。</li>
<li>磁盘阵列（RAID）：多磁盘并行交叉存取，提升I/O吞吐量（如RAID 0的条带化存储）。</li>
</ul>
</li>
</ul>
<p>---</p>
<h3 id="【408易考】I-O控制方式对比小结">【408易考】I/O控制方式对比小结</h3>
<ul>
<li>轮询：CPU占用高；实现最简单；适合极简外设/实时短等待。</li>
<li>中断：CPU占用中；适合多数字符设备与中速外设；可与DMA协作。</li>
<li>DMA：CPU占用低，吞吐高；硬件复杂度中；适合块设备/大块传输。</li>
<li>通道：CPU占用更低并可编排复杂I/O；硬件成本高；适合大型主机/高端存储。</li>
</ul>
<p>---</p>
<h3 id="【408速记】常见易错点">【408速记】常见易错点</h3>
<ul>
<li>非阻塞 ≠ 异步：非阻塞只是“立即返回”，异步强调“完成通知/回调”。</li>
<li>中断驱动并不排斥DMA：常见是“中断+DMA”协同，降低CPU搬运。</li>
<li>SSD无寻道/旋转延迟：传统磁盘调度收益对SSD有限；SSD更关注FTL/写放大（【考纲外】）。</li>
<li>延迟写有一致性风险：关键数据应配合flush/fsync；barrier/日志是深入主题（【考纲外】）。</li>
<li>LOOK/C-LOOK只到最远请求：不必到端点，减少无效寻道。</li>
<li>SPOOLing不等于“立刻打印”：是“先入井排队再后台输出”的虚拟共享。</li>
</ul>
<p>---</p>
<h3 id="附录（考纲外扩展，标注为“【考纲外】”）">附录（考纲外扩展，标注为“【考纲外】”）</h3>
<ul>
<li>
<p>【考纲外】同步/异步 与 阻塞/非阻塞</p>
<ul>
<li>定义：阻塞/非阻塞描述调用是否立即返回；同步/异步描述完成通知与数据搬运的时机与主体。</li>
<li>典型API：POSIX read/write（同步）；select/poll/epoll（就绪通知）；Linux AIO/io_uring、Windows Overlapped I/O/IOCP（异步）。</li>
<li>四象限举例：阻塞+同步（默认read）；非阻塞+同步（O_NONBLOCK+轮询）；异步（提交后回调/事件完成）。</li>
</ul>
</li>
<li>
<p>【考纲外】零拷贝与数据路径</p>
<ul>
<li>手拷贝路径：用户↔内核多次拷贝与上下文切换。</li>
<li>零拷贝手段：mmap、sendfile、splice、MSG_ZEROCOPY；结合页缓存/页框复用与DMA、IOMMU。</li>
<li>适用：高吞吐网络/存储；注意一致性与错误回退处理。</li>
</ul>
</li>
<li>
<p>【考纲外】SSD FTL、GC、Trim 与写放大</p>
<ul>
<li>FTL：维护逻辑块到物理页/块映射（页/块/混合映射）。</li>
<li>写放大：随机更新导致迁移与回收放大写入量；OP（过量预留）与对齐可缓解。</li>
<li>GC/Trim：后台回收无效页；文件删除/释放后通过TRIM/UNMAP通知FTL可回收。</li>
</ul>
</li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://lazy11.top">Lazy</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://lazy11.top/2025/09/19/%E8%80%83%E7%A0%94/408/OS/IO%E7%AE%A1%E7%90%86/">https://lazy11.top/2025/09/19/%E8%80%83%E7%A0%94/408/OS/IO%E7%AE%A1%E7%90%86/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-share"><div class="social-share" data-image="/img/lazy-icon.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/09/22/%E8%80%83%E7%A0%94/408/%E8%AE%A1%E7%BD%91/%E8%AE%A1%E7%BD%91%E6%A6%82%E8%BF%B0/" title="计网概述"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">计网概述</div></div><div class="info-2"><div class="info-item-1">第1章...</div></div></div></a><a class="pagination-related" href="/2025/09/19/%E8%80%83%E7%A0%94/408/OS/%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86/" title="文件管理"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">文件管理</div></div><div class="info-2"><div class="info-item-1">操作系统：文件管理 学习导览（408）  文件系统基础（概念/FCB/inode/打开文件表） 文件的逻辑结构（顺序/索引/索引顺序/散列） 文件的物理结构（连续/链接/FAT/索引/混合） 外存空闲空间管理（空闲表/链表/位示图/成组链接） 目录（结构/实现）与共享（硬/软链接） 文件保护（rwx/目录权限语义/ACL） 文件系统结构与布局、挂载（MBR/超级块/根目录/数据区/挂载） 虚拟文件系统...</div></div></div></a></nav><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comments</span></div></div><div class="comment-wrap"><div><div id="waline-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src= "/img/lazy-icon.png" data-lazy-src="/img/lazy-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Lazy</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">44</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">42</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">22</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/lazyy11"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/lazyy11" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:lazy11@foxmail.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is Lazy's Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text">操作系统：输入&#x2F;输出（I&#x2F;O）管理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E3%80%81I-O%E7%AE%A1%E7%90%86%E5%9F%BA%E7%A1%80"><span class="toc-number">1.0.1.</span> <span class="toc-text">一、I&#x2F;O管理基础</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E8%AE%BE%E5%A4%87%E7%8B%AC%E7%AB%8B%E8%BD%AF%E4%BB%B6"><span class="toc-number">1.0.2.</span> <span class="toc-text">二、设备独立软件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%A4%96%E5%AD%98%E7%AE%A1%E7%90%86"><span class="toc-number">1.0.3.</span> <span class="toc-text">三、外存管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90408%E6%98%93%E8%80%83%E3%80%91I-O%E6%8E%A7%E5%88%B6%E6%96%B9%E5%BC%8F%E5%AF%B9%E6%AF%94%E5%B0%8F%E7%BB%93"><span class="toc-number">1.0.4.</span> <span class="toc-text">【408易考】I&#x2F;O控制方式对比小结</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90408%E9%80%9F%E8%AE%B0%E3%80%91%E5%B8%B8%E8%A7%81%E6%98%93%E9%94%99%E7%82%B9"><span class="toc-number">1.0.5.</span> <span class="toc-text">【408速记】常见易错点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%99%84%E5%BD%95%EF%BC%88%E8%80%83%E7%BA%B2%E5%A4%96%E6%89%A9%E5%B1%95%EF%BC%8C%E6%A0%87%E6%B3%A8%E4%B8%BA%E2%80%9C%E3%80%90%E8%80%83%E7%BA%B2%E5%A4%96%E3%80%91%E2%80%9D%EF%BC%89"><span class="toc-number">1.0.6.</span> <span class="toc-text">附录（考纲外扩展，标注为“【考纲外】”）</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/28/plans/blockchain-learning/" title="blockchain-learning">blockchain-learning</a><time datetime="2025-09-28T14:36:18.000Z" title="Created 2025-09-28 22:36:18">2025-09-28</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/26/%E8%80%83%E7%A0%94/408/%E8%AE%A1%E7%BD%91/%E5%BA%94%E7%94%A8%E5%B1%82/" title="应用层">应用层</a><time datetime="2025-09-26T09:21:23.000Z" title="Created 2025-09-26 17:21:23">2025-09-26</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/26/%E8%80%83%E7%A0%94/408/%E8%AE%A1%E7%BD%91/%E4%BC%A0%E8%BE%93%E5%B1%82/" title="传输层">传输层</a><time datetime="2025-09-26T07:25:00.000Z" title="Created 2025-09-26 15:25:00">2025-09-26</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/25/%E8%80%83%E7%A0%94/%E6%95%B0%E5%AD%A6/%E7%BA%BF%E4%BB%A3/%E7%BA%BF%E4%BB%A3%E4%B8%B2%E8%81%94/" title="线代串联">线代串联</a><time datetime="2025-09-25T05:24:26.000Z" title="Created 2025-09-25 13:24:26">2025-09-25</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/25/%E8%80%83%E7%A0%94/408/%E8%AE%A1%E7%BD%91/%E7%BD%91%E7%BB%9C%E5%B1%82/" title="网络层">网络层</a><time datetime="2025-09-25T05:20:51.000Z" title="Created 2025-09-25 13:20:51">2025-09-25</time></div></div></div></div></div></div></main><footer id="footer" style="background: linear-gradient(45deg, #002FA7, #00B4FF);"><div id="footer-wrap"><div class="copyright">&copy;2024 - 2025 By Lazy</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="Scroll to Comments"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><div class="js-pjax"><script>(async () => {
  const showKatex = () => {
    document.querySelectorAll('#article-container .katex').forEach(el => el.classList.add('katex-show'))
  }

  if (!window.katex_js_css) {
    window.katex_js_css = true
    await btf.getCSS('https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css')
    if (true) {
      await btf.getScript('https://cdn.jsdelivr.net/npm/katex/dist/contrib/copy-tex.min.js')
    }
  }

  showKatex()
})()</script><script>(() => {
  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = `%%{init:{ 'theme':'${theme}'}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (true) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script><script>(() => {
  let initFn = window.walineFn || null
  const isShuoshuo = GLOBAL_CONFIG_SITE.isShuoshuo
  const option = null

  const destroyWaline = ele => ele.destroy()

  const initWaline = (Fn, el = document, path = window.location.pathname) => {
    const waline = Fn({
      el: el.querySelector('#waline-wrap'),
      serverURL: 'https://waline.lazy11.top/',
      pageview: true,
      dark: 'html[data-theme="dark"]',
      comment: false,
      ...option,
      path: isShuoshuo ? path : (option && option.path) || path
    })

    if (isShuoshuo) {
      window.shuoshuoComment.destroyWaline = () => {
        destroyWaline(waline)
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }
  }

  const loadWaline = (el, path) => {
    if (initFn) initWaline(initFn, el, path)
    else {
      btf.getCSS('https://cdn.jsdelivr.net/npm/@waline/client/dist/waline.min.css')
        .then(() => import('https://cdn.jsdelivr.net/npm/@waline/client/dist/waline.min.js'))
        .then(({ init }) => {
          initFn = init || Waline.init
          initWaline(initFn, el, path)
          window.walineFn = initFn
        })
    }
  }

  if (isShuoshuo) {
    'Waline' === 'Waline'
      ? window.shuoshuoComment = { loadComment: loadWaline } 
      : window.loadOtherComment = loadWaline
    return
  }

  if ('Waline' === 'Waline' || !false) {
    if (false) btf.loadComment(document.getElementById('waline-wrap'),loadWaline)
    else setTimeout(loadWaline, 0)
  } else {
    window.loadOtherComment = loadWaline
  }
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章..." type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>